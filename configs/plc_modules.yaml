# PLC 模块配置文件 - 料仓项目精简版
# 仅保留四个基础模块：PM10、温度、电表、振动(DB4 60~144)

modules:
  # ============================================================
  # 1. PM10 粉尘浓度传感器模块 (PM10Sensor)
  # ============================================================
  # Offset: 0-1 (2 bytes)
  # 数据类型: Word (无符号16位整数)，单位 μg/m³
  - name: PM10Sensor
    description: PM10 粉尘浓度传感器模块
    total_size: 2
    fields:
      - name: Concentration
        display_name: PM10浓度
        data_type: Word
        offset: 0
        size: 2
        unit: μg/m³
        scale: 1.0

  # ============================================================
  # 2. 温度传感器模块 (TemperatureSensor)
  # ============================================================
 
  # 数据类型: SINT16 (有符号16位整数)，单位 0.1摄氏度
  # 例如: PLC存储 1500 表示 150.0°C，存储 -50 表示 -5.0°C
  - name: TemperatureSensor
    description: 温度传感器模块 (SINT16, 0.1°C)
    total_size: 2
    fields:
      - name: Temperature
        display_name: 当前温度
        data_type: Int
        offset: 0
        size: 2
        unit: °C
        scale: 1.0  # 缩放在 converter_temp.py 中处理 (乘以0.1)

  # ============================================================
  # 3. 电表模块 (ElectricityMeter) - 完整版
  # ============================================================
  # Offset: 4-59 (56 bytes = 14个Real)
  - name: ElectricityMeter
    description: 三相电表模块 (完整)
    total_size: 56
    fields:
      # 线电压 Uab (3个Real = 12 bytes)
      - name: Uab_0
        display_name: A-B线电压
        data_type: Real
        offset: 0
        size: 4
        unit: V
        scale: 1.0
      - name: Uab_1
        display_name: B-C线电压
        data_type: Real
        offset: 4
        size: 4
        unit: V
        scale: 1.0
      - name: Uab_2
        display_name: C-A线电压
        data_type: Real
        offset: 8
        size: 4
        unit: V
        scale: 1.0
      
      # 相电压 Ua (3个Real = 12 bytes)
      - name: Ua_0
        display_name: A相电压
        data_type: Real
        offset: 12
        size: 4
        unit: V
        scale: 1.0
      - name: Ua_1
        display_name: B相电压
        data_type: Real
        offset: 16
        size: 4
        unit: V
        scale: 1.0
      - name: Ua_2
        display_name: C相电压
        data_type: Real
        offset: 20
        size: 4
        unit: V
        scale: 1.0
      
      # 电流 I (3个Real = 12 bytes)
      - name: I_0
        display_name: A相电流
        data_type: Real
        offset: 24
        size: 4
        unit: A
        scale: 1.0
      - name: I_1
        display_name: B相电流
        data_type: Real
        offset: 28
        size: 4
        unit: A
        scale: 1.0
      - name: I_2
        display_name: C相电流
        data_type: Real
        offset: 32
        size: 4
        unit: A
        scale: 1.0
      
      # 功率 (4个Real = 16 bytes)
      - name: Pt
        display_name: 总有功功率
        data_type: Real
        offset: 36
        size: 4
        unit: kW
        scale: 1.0
      - name: Pa
        display_name: A相有功功率
        data_type: Real
        offset: 40
        size: 4
        unit: kW
        scale: 1.0
      - name: Pb
        display_name: B相有功功率
        data_type: Real
        offset: 44
        size: 4
        unit: kW
        scale: 1.0
      - name: Pc
        display_name: C相有功功率
        data_type: Real
        offset: 48
        size: 4
        unit: kW
        scale: 1.0
      
      # 电能 (1个Real = 4 bytes)
      - name: ImpEp
        display_name: 正向有功总电能
        data_type: Real
        offset: 52
        size: 4
        unit: kWh
        scale: 1.0

  # ============================================================
  # 4. 振动传感器精简模块 (VibrationSelected) - DB4专用
  # ============================================================
  # 基于 PLC DB4 实际结构 (偏移 60.0 ~ 142.0, 共 84 字节)
  # 只保留三组核心数据: V_xyz (速度), D_xyz (位移), HZ_xyz (频率)
  # 总大小: 84 bytes (0-83)
  - name: VibrationSelected
    description: 振动传感器精简模块（V/D/HZ三组数据）
    total_size: 84
    fields:
      # ========== 1. 速度幅值 (VIBRATION_VEL_A) ==========
      # DB4绝对偏移: 72.0-76.0 (相对振动模块起始偏移60.0, 这里是12-17)
      # 计算公式: VX(mm/s) = ((VXH << 8) | VXL) / 100
      - name: VX
        display_name: X轴速度幅值
        data_type: Word
        offset: 12
        size: 2
        unit: mm/s
        scale: 1

      - name: VY
        display_name: Y轴速度幅值
        data_type: Word
        offset: 14
        size: 2
        unit: mm/s
        scale: 1

      - name: VZ
        display_name: Z轴速度幅值
        data_type: Word
        offset: 16
        size: 2
        unit: mm/s
        scale: 1

      # ========== 2. 位移幅值 (VIBRATION_DIS_A) ==========
      # DB4绝对偏移: 86.0-90.0 (相对振动模块起始偏移60.0, 这里是26-31)
      # 计算公式: DX(μm) = ((DXH << 8) | DXL) / 100
      - name: DX
        display_name: X轴位移幅值
        data_type: Word
        offset: 26
        size: 2
        unit: μm
        scale: 1

      - name: DY
        display_name: Y轴位移幅值
        data_type: Word
        offset: 28
        size: 2
        unit: μm
        scale: 1

      - name: DZ
        display_name: Z轴位移幅值
        data_type: Word
        offset: 30
        size: 2
        unit: μm
        scale: 1

      # ========== 3. 频率 (VIBRATION_FREQ) ==========
      # DB4绝对偏移: 92.0-96.0 (相对振动模块起始偏移60.0, 这里是32-37)
      # 计算公式: HZX(Hz) = ((HZXH << 8) | HZXL) / 10
      - name: HZX
        display_name: X轴频率
        data_type: Word
        offset: 32
        size: 2
        unit: Hz
        scale: 1

      - name: HZY
        display_name: Y轴频率
        data_type: Word
        offset: 34
        size: 2
        unit: Hz
        scale: 1

      - name: HZZ
        display_name: Z轴频率
        data_type: Word
        offset: 36
        size: 2
        unit: Hz
        scale: 1
