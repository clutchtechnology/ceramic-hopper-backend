"""
PLC 模块配置文件 - 料仓项目精简版
仅保留四个基础模块：PM10、温度、电表、振动(DB4 60~144)
"""

modules:
  # ============================================================
  # 1. PM10 粉尘浓度传感器模块 (PM10Sensor)
  # ============================================================
  # Offset: 0-1 (2 bytes)
  # 数据类型: Word (无符号16位整数)，单位 μg/m³
  - name: PM10Sensor
    description: PM10 粉尘浓度传感器模块
    total_size: 2
    fields:
      - name: Concentration
        display_name: PM10浓度
        data_type: Word
        offset: 0
        size: 2
        unit: μg/m³
        scale: 1.0

  # ============================================================
  # 2. 温度传感器模块 (TemperatureSensor)
  # ============================================================
  # Offset: 24-25 (2 bytes)
  # 数据类型: SINT16 (有符号16位整数)，单位 0.1摄氏度
  # 例如: PLC存储 1500 表示 150.0°C，存储 -50 表示 -5.0°C
  - name: TemperatureSensor
    description: 温度传感器模块 (SINT16, 0.1°C)
    total_size: 2
    fields:
      - name: Temperature
        display_name: 当前温度
        data_type: Int
        offset: 0
        size: 2
        unit: °C
        scale: 1.0  # 缩放在 converter_temp.py 中处理 (乘以0.1)

  # ============================================================
  # 3. 电表模块 (ElectricityMeter) - 完整版
  # ============================================================
  # Offset: 4-59 (56 bytes = 14个Real)
  - name: ElectricityMeter
    description: 三相电表模块 (完整)
    total_size: 56
    fields:
      # 线电压 Uab (3个Real = 12 bytes)
      - name: Uab_0
        display_name: A-B线电压
        data_type: Real
        offset: 0
        size: 4
        unit: V
        scale: 1.0
      - name: Uab_1
        display_name: B-C线电压
        data_type: Real
        offset: 4
        size: 4
        unit: V
        scale: 1.0
      - name: Uab_2
        display_name: C-A线电压
        data_type: Real
        offset: 8
        size: 4
        unit: V
        scale: 1.0
      
      # 相电压 Ua (3个Real = 12 bytes)
      - name: Ua_0
        display_name: A相电压
        data_type: Real
        offset: 12
        size: 4
        unit: V
        scale: 1.0
      - name: Ua_1
        display_name: B相电压
        data_type: Real
        offset: 16
        size: 4
        unit: V
        scale: 1.0
      - name: Ua_2
        display_name: C相电压
        data_type: Real
        offset: 20
        size: 4
        unit: V
        scale: 1.0
      
      # 电流 I (3个Real = 12 bytes)
      - name: I_0
        display_name: A相电流
        data_type: Real
        offset: 24
        size: 4
        unit: A
        scale: 1.0
      - name: I_1
        display_name: B相电流
        data_type: Real
        offset: 28
        size: 4
        unit: A
        scale: 1.0
      - name: I_2
        display_name: C相电流
        data_type: Real
        offset: 32
        size: 4
        unit: A
        scale: 1.0
      
      # 功率 (4个Real = 16 bytes)
      - name: Pt
        display_name: 总有功功率
        data_type: Real
        offset: 36
        size: 4
        unit: kW
        scale: 1.0
      - name: Pa
        display_name: A相有功功率
        data_type: Real
        offset: 40
        size: 4
        unit: kW
        scale: 1.0
      - name: Pb
        display_name: B相有功功率
        data_type: Real
        offset: 44
        size: 4
        unit: kW
        scale: 1.0
      - name: Pc
        display_name: C相有功功率
        data_type: Real
        offset: 48
        size: 4
        unit: kW
        scale: 1.0
      
      # 电能 (1个Real = 4 bytes)
      - name: ImpEp
        display_name: 正向有功总电能
        data_type: Real
        offset: 52
        size: 4
        unit: kWh
        scale: 1.0

  # ============================================================
  # 4. 振动传感器精简模块 (VibrationSelected) - DB4专用
  # ============================================================
  # 基于 PLC DB4 实际结构 (偏移 60.0 ~ 142.0, 共 84 字节)
  # 只保留 PLC 工程师标注的有注释字段
  # 总大小: 84 bytes (0-83)
  - name: VibrationSelected
    description: 振动传感器精简模块（只保留标注字段）
    total_size: 84
    fields:
      # ========== 振动位移幅值 (VIBRATION_DIS_A) ==========
      # 偏移: 60.0-64.0 (6 bytes)
      # 寄存器地址: 65~67 (0x41~0x43)
      # 量程模式选择:
      #   模式1 (当前配置): 60000μm量程, 1μm分辨率, scale=1.0
      #     计算公式: DX(μm) = (DXH << 8) | DXL
      #   模式2 (高精度模式): 600μm量程, 0.01μm分辨率, scale=0.01
      #     计算公式: DX(μm) = ((DXH << 8) | DXL) / 100
      # 如需切换到高精度模式，将下面的 scale 从 1.0 改为 0.01
      - name: DX
        display_name: X轴振动位移幅值
        data_type: Word
        offset: 0
        size: 2
        unit: μm
        scale: 1.0

      - name: DY
        display_name: Y轴振动位移幅值
        data_type: Word
        offset: 2
        size: 2
        unit: μm
        scale: 1.0

      - name: DZ
        display_name: Z轴振动位移幅值
        data_type: Word
        offset: 4
        size: 2
        unit: μm
        scale: 1.0

      # ========== 振动频率 (VIBRATION_FREQ) ==========
      # 偏移: 66.0-70.0 (6 bytes)
      # 寄存器地址: 68~70 (0x44~0x46)
      # 计算公式: HZX(Hz) = ((HZXH << 8) | HZXL) / 10
      # scale=0.1 完成 /10 转换
      - name: HZX
        display_name: X轴振动频率
        data_type: Word
        offset: 6
        size: 2
        unit: Hz
        scale: 0.1

      - name: HZY
        display_name: Y轴振动频率
        data_type: Word
        offset: 8
        size: 2
        unit: Hz
        scale: 0.1

      - name: HZZ
        display_name: Z轴振动频率
        data_type: Word
        offset: 10
        size: 2
        unit: Hz
        scale: 0.1

      # ========== X轴数据 (X_DATA) ==========
      # 偏移: 72.0-94.0 (24 bytes)
      - name: KX
        display_name: X轴加速度峰值
        data_type: Word
        offset: 14
        size: 2
        unit: m/s²
        scale: 0.01

      - name: VRMSX
        display_name: X轴速度RMS值
        data_type: Word
        offset: 30
        size: 2
        unit: mm/s
        scale: 0.1

      # ========== Y轴数据 (Y_DATA) ==========
      # 偏移: 96.0-118.0 (24 bytes)
      - name: AAVGY
        display_name: Y轴加速度峰值
        data_type: Word
        offset: 40
        size: 2
        unit: m/s²
        scale: 0.01

      - name: VRMSY
        display_name: Y轴速度RMS值
        data_type: Word
        offset: 54
        size: 2
        unit: mm/s
        scale: 0.1

      # ========== Z轴数据 (Z_DATA) ==========
      # 偏移: 120.0-142.0 (24 bytes)
      - name: AAVGZ
        display_name: Z轴加速度峰值
        data_type: Word
        offset: 64
        size: 2
        unit: m/s²
        scale: 0.01

      - name: VRMGZ
        display_name: Z轴速度RMS值
        data_type: Word
        offset: 78
        size: 2
        unit: mm/s
        scale: 0.1
